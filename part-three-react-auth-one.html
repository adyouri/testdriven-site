<!DOCTYPE html>
<html>

  <head>
  <!-- meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" type="image/png" href="/favicon.png">
  <!-- og -->
  
  <!-- description -->
  
  <!-- keywords -->
  
  <!-- title -->
  
    <title>Microservices with Docker, Flask, and React - React Auth - part one</title>
    <meta property="og:title" content="Microservices with Docker, Flask, and React - React Auth - part one" />
  
  <!-- styles -->
  <link rel="stylesheet" href="/assets/vendor/bootstrap.min.css">
  <link href="//use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
  <link href="/assets/css/styles.css?1521989479379104000" rel="stylesheet">
</head>


  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img
        class="nav-logo" src="/assets/img/test_driven_io_full_logo_white_text.svg" alt="testdriven.io"
      />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="/">Course</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/course-contents">Contents</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/testimonials">Testimonials</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
      </ul>
    </div>
    <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
      <li class="nav-item">
        <a class="nav-link" href="https://twitter.com/testdrivenio"><i class="fab fa-twitter"></i></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/testdrivenio"><i class="fab fa-github"></i></a>
      </li>
      <li class="nav-item nav-purcahse-btn">
        <a class="btn btn-outline-warning" href="https://gum.co/flask">Purchase the Course</a>
      </li>
  </ul>
  </div>
</nav>


    <div class="container">
      <div class="row">

        <div class="col-sm-3 d-none d-md-block">
    <div id="toc-block" class="collection">
      <ul class="collapsible collapsible-accordion">
        <br>
        <!--  init break_flag -->
        

        <!-- outer loop -->
        
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            
            <li>
              <!-- create header for part -->
              <h5 class="btn btn-outline-dark btn-block" data-toggle="collapse" href="#collapse1">
                Part 1
              </h5>
              <!-- create ul for hidden part content -->
              <ul data-part="1" class="collapse" id="collapse1" style="padding:0">

                <!-- nested loop -->
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-intro">
                            Introduction
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-microservices">
                            Microservices
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-app-overview">
                            App Overview
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-getting-started">
                            Getting Started
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-docker-config">
                            Docker Config
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-postgres-setup">
                            Postgres Setup
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-test-setup">
                            Test Setup
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-flask-blueprints">
                            Flask Blueprints
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-restful-routes">
                            RESTful Routes
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-deployment">
                            Deployment
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-jinja-templates">
                            Jinja Templates
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-workflow">
                            Workflow
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-one-structure">
                            Structure
                          </a>
                        </span>
                      </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                <br>
              </ul>
            
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            
            <li>
              <!-- create header for part -->
              <h5 class="btn btn-outline-dark btn-block" data-toggle="collapse" href="#collapse2">
                Part 2
              </h5>
              <!-- create ul for hidden part content -->
              <ul data-part="2" class="collapse" id="collapse2" style="padding:0">

                <!-- nested loop -->
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-intro">
                            Introduction
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-code-coverage-and-quality">
                            Code Coverage and Quality
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-continuous-integration">
                            Continuous Integration
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-flask-debug-toolbar">
                            Flask Debug Toolbar
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-react-setup">
                            React Setup
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-testing-react">
                            Testing React
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-react-forms">
                            React Forms
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-react-and-docker">
                            React and Docker
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-next-steps">
                            Next Steps
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-two-structure">
                            Structure
                          </a>
                        </span>
                      </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                <br>
              </ul>
            
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            
            <li>
              <!-- create header for part -->
              <h5 class="btn btn-outline-dark btn-block" data-toggle="collapse" href="#collapse3">
                Part 3
              </h5>
              <!-- create ul for hidden part content -->
              <ul data-part="3" class="collapse" id="collapse3" style="padding:0">

                <!-- nested loop -->
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-into">
                            Introduction
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-flask-migrate">
                            Flask Migrate
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-flask-bcrypt">
                            Flask Bcrypt
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-jwt-setup">
                            JWT Setup
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-auth-routes">
                            Auth Routes
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-react-router">
                            React Router
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-react-bootstrap">
                            React Bootstrap
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-react-auth-one">
                            React Auth - part one
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-mocking-user-interaction">
                            Mocking User Interaction
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-react-auth-two">
                            React Auth - part two
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-authorization">
                            Authorization
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-update-component">
                            Update Component
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-update-docker">
                            Update Docker
                          </a>
                        </span>
                      </li>
                  
                
                  
                    <li>
                        <span class="badge">&bull;</span>
                        <span>
                          <a href="https://testdriven.io/part-three-structure">
                            Structure
                          </a>
                        </span>
                      </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                <br>
              </ul>
            
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
          <!-- resets break_flag if the current post_part has incremented -->
          
          <!-- creates header and content for each part -->
          <!-- break_flag prevents header and content creation being repeated for each post.part -->
          
            <!-- stops nested loop after first itration  -->
            
          
        </li>
      </ul>
    </div>
  </div>


        <div class="col-md-9">

          <h1>React Auth - part one</h1>

          

            <h5>Part 3, Lesson 8</h5>

            <div class="page-nav">
              <br>
              
                <a class="btn btn-outline-success" href="https://testdriven.io/part-three-react-bootstrap">&laquo; React Bootstrap</a>
              
              
                <a class="btn btn-outline-success" href="https://testdriven.io/part-three-mocking-user-interaction">Mocking User Interaction &raquo;</a>
              
            </div>

            
  
    <br>
    <a class="twitter-share-button" data-show-count="false" href="https://twitter.com/intent/tweet?text=Microservices with Docker, Flask, and React - React Auth - part one&amp;url=https%3A%2F%2Ftestdriven.io/part-three-react-auth-one&amp;via=testdrivenio" rel="nofollow" target="_blank" title="Share on Twitter"></a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  



            <br><br>

          

          <p>Moving right along, let’s add some methods to handle a user signing up, logging in, and logging out…</p>

<hr />

<p>With the <code class="highlighter-rouge">Form</code> component set up, we can now configure the methods to:</p>

<ol>
  <li>Handle form submit event</li>
  <li>Obtain user input</li>
  <li>Send AJAX request</li>
  <li>Update the page</li>
</ol>

<blockquote>
  <p>These steps should look familiar since we already went through this process in the <a href="https://testdriven.io/part-two-react-forms">React Forms</a> lesson. Put your skills to the test and implement the code on your own before going through this lesson.</p>
</blockquote>

<h2 id="handle-form-submit-event">Handle form submit event</h2>

<p>Turn to <em>Form.jsx</em>. Which method gets fired on the form submit?</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">props</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="p">(</span><span class="nx">event</span><span class="p">)}</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>Add the method to the <code class="highlighter-rouge">App</code> component:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">handleUserFormSubmit</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'sanity check!'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Bind the method in the constructor:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</code></pre></div></div>

<p>And then pass it down via the <code class="highlighter-rouge">props</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">'/register'</span> <span class="nx">render</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Form</span>
    <span class="na">formType=</span><span class="si">{</span><span class="s1">'Register'</span><span class="si">}</span>
    <span class="na">formData=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="si">}</span>
    <span class="na">handleUserFormSubmit=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">'/login'</span> <span class="nx">render</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Form</span>
    <span class="na">formType=</span><span class="si">{</span><span class="s1">'Login'</span><span class="si">}</span>
    <span class="na">formData=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="si">}</span>
    <span class="na">handleUserFormSubmit=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span></code></pre></div></div>

<p>To test, remove the <code class="highlighter-rouge">required</code> attribute on each of the form <code class="highlighter-rouge">input</code>s in <em>services/client/src/components/Form.jsx</em>. Then, you should see <code class="highlighter-rouge">sanity check!</code> in the JavaScript console on form submit for both forms in the browser.</p>

<div style="text-align:left;">
  <img src="/assets/img/course/03_react_form_submit_test.png" style="max-width: 100%; border:0; box-shadow: none;" alt="react auth" />
</div>

<p>Remove <code class="highlighter-rouge">console.log('sanity check!')</code> and add the <code class="highlighter-rouge">required</code> attributes back when done.</p>

<h2 id="obtain-user-input">Obtain user input</h2>

<p>Next, to get the user inputs, add the following method to the <code class="highlighter-rouge">App</code> component:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">handleFormChange</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="p">;</span>
  <span class="nx">obj</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Again, bind it in the constructor, and then pass it down to the components via the <code class="highlighter-rouge">props</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">handleFormChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormChange</span><span class="p">}</span>
</code></pre></div></div>

<p>Add a <code class="highlighter-rouge">console.log()</code> to the method - <code class="highlighter-rouge">console.log(this.state.formData);</code> - to ensure it works when you test it in the browser. Remove it once done.</p>

<p>What’s next? AJAX!</p>

<h2 id="send-ajax-request">Send AJAX request</h2>

<p>Update the <code class="highlighter-rouge">handleUserFormSubmit</code> method to send the data to the <code class="highlighter-rouge">user</code> service on a successful form submit:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">handleUserFormSubmit</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">formType</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">).</span><span class="nx">reverse</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span>
  <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">email</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
    <span class="na">password</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span>
  <span class="p">};</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">formType</span> <span class="o">===</span> <span class="s1">'register'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="p">.</span><span class="nx">username</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REACT_APP_USERS_SERVICE_URL</span><span class="p">}</span><span class="s2">/auth/</span><span class="p">${</span><span class="nx">formType</span><span class="p">}</span><span class="s2">`</span>
  <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Add a new <code class="highlighter-rouge">location</code> block to both Nginx config files to handle requests to <code class="highlighter-rouge">/auth</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>location /auth {
  proxy_pass        http://users:5000;
  proxy_redirect    default;
  proxy_set_header  Host $host;
  proxy_set_header  X-Real-IP $remote_addr;
  proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header  X-Forwarded-Host $server_name;
}
</code></pre></div></div>

<p>Set the <code class="highlighter-rouge">REACT_APP_USERS_SERVICE_URL</code> environment variable:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">REACT_APP_USERS_SERVICE_URL</span><span class="o">=</span>http://DOCKER_MACHINE_DEV_IP
</code></pre></div></div>

<p>Update the containers:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose <span class="nt">-f</span> docker-compose-dev.yml up <span class="nt">-d</span> <span class="nt">--build</span>
</code></pre></div></div>

<p>Test the user registration out. If you have everything set up correctly, you should see an object in the JavaScript console with an auth token:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"auth_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0OTc3NTM2ODMsImlhdCI6MTQ5Nzc1MzY3OCwic3ViIjo0fQ.vcRFb5v3znHkz8An12QUxrgXsLqoKv93kIsMf-pdfVw"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Successfully registered."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div style="text-align:left;">
  <img src="/assets/img/course/03_react_form_ajax_test.png" style="max-width: 100%; border:0; box-shadow: none;" alt="react auth" />
</div>

<p>Test logging in as well. Again, you should see the very same object in the console.</p>

<h2 id="update-the-page">Update the page</h2>

<p>After a user register or logs in, we need to:</p>

<ol>
  <li>Clear the <code class="highlighter-rouge">formData</code> object</li>
  <li>Save the auth token in the browser’s <a href="https://developer.mozilla.org/en-US/docs/Web/API/Storage/LocalStorage">LocalStorage</a>, a client-side data store</li>
  <li>Update the state to indicate that the user is authenticated</li>
  <li>Redirect the user to <code class="highlighter-rouge">/</code></li>
</ol>

<p>First, to clear the form, update the <code class="highlighter-rouge">.then</code> block within <code class="highlighter-rouge">handleUserFormSubmit()</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
    <span class="na">formData</span><span class="p">:</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="s1">''</span> <span class="p">},</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="s1">''</span>
  <span class="p">});</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Try this out. After you register or log in, the field inputs should be cleared since we set the properties in the <code class="highlighter-rouge">formData</code> object to empty strings.</p>

<blockquote>
  <p>What happens if you enter data for the registration form but <em>don’t</em> submit it and then navigate to the login form? The fields should remain. Is this okay? Should we clear the state on page load? Your call. You could simply update the state within the <code class="highlighter-rouge">componentWillMount</code> lifecycle method.</p>
</blockquote>

<p>Next, let’s save the auth token in LocalStorage so that we can use it for subsequent API calls that require a user to be authenticated. To do this, add the following code to the <code class="highlighter-rouge">.then</code>, just below the <code class="highlighter-rouge">setState</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'authToken'</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">auth_token</span><span class="p">);</span>
</code></pre></div></div>

<p>Try logging in again. After a successful login, open the “Application” tab in <a href="https://developer.chrome.com/devtools">Chrome DevTools</a>. Click the arrow pointing toward <a href="https://developers.google.com/web/tools/chrome-devtools/manage-data/local-storage">LocalStorage</a> and select the IP (which should be the IP associated with the Docker Machine). You should see a key of <code class="highlighter-rouge">authToken</code> with a value of the actual token in the pane.</p>

<div style="text-align:left;">
  <img src="/assets/img/course/03_react_auth_login.png" style="max-width: 100%; border:0; box-shadow: none;" alt="react auth" />
</div>

<p>Instead of always checking LocalStorage for the auth token, let’s add a boolean to the state so we can quickly tell if a user is authenticated.</p>

<p>Add an <code class="highlighter-rouge">isAuthenticated</code> property to the state:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">users</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">title</span><span class="p">:</span> <span class="s1">'TestDriven.io'</span><span class="p">,</span>
  <span class="na">formData</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">password</span><span class="p">:</span> <span class="s1">''</span>
  <span class="p">},</span>
  <span class="na">isAuthenticated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Now, we can update the state in the <code class="highlighter-rouge">.then</code> within <code class="highlighter-rouge">handleUserFormSubmit()</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
  <span class="na">formData</span><span class="p">:</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="s1">''</span> <span class="p">},</span>
  <span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">isAuthenticated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Finally, to redirect the user after a successful log in or registration, pass <code class="highlighter-rouge">isAuthenticated</code> through to the <code class="highlighter-rouge">Form</code> component:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">'/register'</span> <span class="nx">render</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Form</span>
    <span class="na">formType=</span><span class="si">{</span><span class="s1">'Register'</span><span class="si">}</span>
    <span class="na">formData=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="si">}</span>
    <span class="na">handleUserFormSubmit=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="si">}</span>
    <span class="na">handleFormChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormChange</span><span class="si">}</span>
    <span class="na">isAuthenticated=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">'/login'</span> <span class="nx">render</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Form</span>
    <span class="na">formType=</span><span class="si">{</span><span class="s1">'Login'</span><span class="si">}</span>
    <span class="na">formData=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">formData</span><span class="si">}</span>
    <span class="na">handleUserFormSubmit=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleUserFormSubmit</span><span class="si">}</span>
    <span class="na">handleFormChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormChange</span><span class="si">}</span>
    <span class="na">isAuthenticated=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span></code></pre></div></div>

<p>Then, within <em>Form.jsx</em> add the following conditional right before the <code class="highlighter-rouge">return</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">&lt;</span><span class="nc">Redirect</span> <span class="na">to=</span><span class="s1">'/'</span> <span class="p">/&gt;;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Add the import:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Redirect</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-router-dom'</span><span class="p">;</span>
</code></pre></div></div>

<p>To test, log in and then make sure that you are redirected to <code class="highlighter-rouge">/</code>. Also, once logged in, you should be redirected if you try to go to the <code class="highlighter-rouge">/register</code> or <code class="highlighter-rouge">/login</code> links. Before moving on, try registering a new user. Did you notice that even though the redirect works, the user list is not updating?</p>

<p>To update that, fire <code class="highlighter-rouge">this.getUsers()</code> in the <code class="highlighter-rouge">.then</code> within <code class="highlighter-rouge">handleUserFormSubmit()</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
    <span class="na">formData</span><span class="p">:</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="s1">''</span><span class="p">},</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">isAuthenticated</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">});</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'authToken'</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">auth_token</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">getUsers</span><span class="p">();</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Test it out again.</p>

<h2 id="logout">Logout</h2>

<p>How about logging out? Add a new file called <em>Logout.test.jsx</em> to the  “services/client/src/components/__tests__” directory:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">shallow</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'enzyme'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Logout</span> <span class="k">from</span> <span class="s1">'../Logout'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">logoutUser</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'Logout renders properly'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(&lt;</span><span class="nc">Logout</span> <span class="na">logoutUser=</span><span class="si">{</span><span class="nx">logoutUser</span><span class="si">}</span><span class="p">/&gt;);</span>
  <span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'p'</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">'You are now logged out.'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Here, we’re using <code class="highlighter-rouge">jest.fn()</code> to <a href="http://facebook.github.io/jest/docs/en/mock-function-api.html#mockfnmockimplementationfn">mock</a> the  <code class="highlighter-rouge">logoutUser</code> function. Ensure the tests fail, and then add a new component to the “components” folder called <em>Logout.jsx</em>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Link</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-router-dom'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Logout</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">logoutUser</span><span class="p">();</span>
  <span class="p">};</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>You are now logged out. Click <span class="p">&lt;</span><span class="nc">Link</span> <span class="na">to=</span><span class="s2">"/login"</span><span class="p">&gt;</span>here<span class="p">&lt;/</span><span class="nc">Link</span><span class="p">&gt;</span> to log back in.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Logout</span><span class="p">;</span>
</code></pre></div></div>

<p>Then, add a <code class="highlighter-rouge">logoutUser</code> method to the <code class="highlighter-rouge">App</code> component to remove the token from LocalStorage and update the state:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">logoutUser</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">isAuthenticated</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Bind the method:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">logoutUser</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">logoutUser</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</code></pre></div></div>

<p>Import the component into <em>App.jsx</em>, and then add the new route:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">'/logout'</span> <span class="nx">render</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Logout</span>
    <span class="na">logoutUser=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">logoutUser</span><span class="si">}</span>
    <span class="na">isAuthenticated=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span></code></pre></div></div>

<p>To test:</p>

<ol>
  <li>Log in</li>
  <li>Verify that the token was added to LocalStorage</li>
  <li>Log out</li>
  <li>Verify that the token was removed from LocalStorage</li>
</ol>

<p>Once you’re done manually testing in the browser, ensure the unit tests pass. Then, add a snapshot test:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">test</span><span class="p">(</span><span class="s1">'Logout renders a snapshot properly'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Router</span><span class="p">&gt;&lt;</span><span class="nc">Logout</span> <span class="na">logoutUser=</span><span class="si">{</span><span class="nx">logoutUser</span><span class="si">}</span><span class="p">/&gt;&lt;/</span><span class="nc">Router</span><span class="p">&gt;</span>
  <span class="p">).</span><span class="nx">toJSON</span><span class="p">();</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">tree</span><span class="p">).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<p>We need to provide the <code class="highlighter-rouge">&lt;Router&gt;</code> context (via the <a href="https://reacttraining.com/react-router/core/api/MemoryRouter">MemoryRouter</a>) since it’s required in the component (by the <code class="highlighter-rouge">Link</code>).</p>

<p>Don’t forget the imports:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">renderer</span> <span class="k">from</span> <span class="s1">'react-test-renderer'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MemoryRouter</span> <span class="k">as</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-router-dom'</span><span class="p">;</span>
</code></pre></div></div>

<p>Ensure the tests pass:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PASS  src/components/__tests__/NavBar.test.jsx
PASS  src/components/__tests__/App.test.jsx
PASS  src/components/__tests__/Logout.test.jsx
PASS  src/components/__tests__/UsersList.test.jsx
PASS  src/components/__tests__/About.test.jsx
PASS  src/components/__tests__/Form.test.jsx
PASS  src/components/__tests__/AddUser.test.jsx

Test Suites: 7 passed, 7 total
Tests:       15 passed, 15 total
Snapshots:   7 passed, 7 total
Time:        3.847s, estimated 5s
Ran all <span class="nb">test </span>suites.
</code></pre></div></div>

<p>Commit your code.</p>


          

            
  
    <br>
    <a class="twitter-share-button" data-show-count="false" href="https://twitter.com/intent/tweet?text=Microservices with Docker, Flask, and React - React Auth - part one&amp;url=https%3A%2F%2Ftestdriven.io/part-three-react-auth-one&amp;via=testdrivenio" rel="nofollow" target="_blank" title="Share on Twitter"></a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  



            <div class="page-nav">
              <br>
              
                <a class="btn btn-outline-success" href="https://testdriven.io/part-three-react-bootstrap">&laquo; React Bootstrap</a>
              
              
                <a class="btn btn-outline-success" href="https://testdriven.io/part-three-mocking-user-interaction">Mocking User Interaction &raquo;</a>
              
            </div>

          

        </div>

      </div>
    </div>

     <footer class="footer text-center">
  <div class="container">
    <hr>
    <small>
      <p>
      <span>&copy; Copyright 2018</span>
      <a href="http://testdriven.io">TestDriven.io</a>.
      <br>
      <span>Developed by </span>
      <a href="http://mherman.org/">Michael Herman</a>.
      <br>
      <span>Questions? </span>
      <a href="mailto:michael@mherman.org">michael@mherman.org</a>
      <p>
    </small>
  </div>
</footer>


    <script
  src="//code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"
></script>
<script
  src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
  crossorigin="anonymous"
></script>
<script
  type="text/javascript"
  src="/assets/js/main.js"
></script>
<script
  type="text/javascript"
  src="https://gumroad.com/js/gumroad.js"
></script>
<!-- addthis -->

  <script
    type="text/javascript"
    src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50e5f1cc35ad077d"
  ></script>



    
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-100160465-1', 'auto');
    ga('send', 'pageview');

  </script>



  </body>
</html>
